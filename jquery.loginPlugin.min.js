(function(d){loginDefaults={method:null,action:null,email:false,width:"auto",height:"auto",background:null,title:"Login",cancel:false,label:true};var c={};var b;var e;function a(f,h,g){d(f).find("#"+h).after('<div id="login-error" style="position:absolute;max-height:100px;"><div class="triangle"></div><div style="padding:3px;font-size:10px;font-family:Arial;background:#2f2f2f;border-radius:3px;min-width:150px;text-align:center;color:SeaShell;">'+g+"</div></div>");var i=d(f).find("#"+h).next("#login-error");d(i).css("top",d(f).find("#"+h).offset().top+d(f).find("#"+h).height()+3+5);d(i).css("left",d(f).find("#"+h).offset().left);d(i).css("left",d(i).offset().left+(d(f).find("#"+h).width()/2)-(d(i).width()/2));d(i).find(".triangle").css("left",(d(i).width()/2)-3)}d.fn.extend({createLogin:function(j,i,g,h){var f=this;if(g==undefined){g="userid"}if(h==undefined){h="password"}b=g;e=h;if(j!="one-line"&&j!="normal"){j="normal"}if(i!=undefined){d.each(loginDefaults,function(l,m){if(i[l]==null){c[l]=m}else{c[l]=i[l]}})}else{c=loginDefaults}d(this).append('<form id="login-box" class="'+j+'"></form>');var k=d(this).find("#login-box");if(c.background!=null){d(k).css("background",c.background)}d(k).css("width",c.width);d(k).css("height",c.height);if(c.method!=null){d(k).attr("method",c.method)}if(c.action!=null){d(k).attr("action",c.action)}switch(j){case"one-line":if(c.label){d(k).append('<label for="'+g+'">Username</label>');d(k).append('<input type="text" class="'+g+'" id="'+g+'" name="'+g+'">')}else{d(k).append('<input type="text" class="'+g+'" id="'+g+'" name="'+g+'">');d(k).append('<span style="position:absolute;" class="username-label">Username</span>');d(this).find("#login-box .username-label").css("left",d(this).find("#"+g).offset().left)}if(c.label){d(k).append('<label for="'+h+'">Password</label>');d(k).append('<input type="password" class="'+h+'" id="'+h+'" name="'+h+'">')}else{d(k).append('<input type="password" class="'+h+'" id="'+h+'" name="'+h+'">');d(k).append('<span style="position:absolute;" class="pwd-label">Password</span>');d(this).find("#login-box .pwd-label").css("left",d(this).find("#"+h).offset().left)}d(k).append('<button type="submit" id="submit">Login</button>');if(c.cancel){d(k).append('<button type="cancel" id="cancel">Cancel</button>')}break;case"normal":if(c.title!="none"){d(k).append('<div class="loginTitle">'+c.title+"</div><br>")}if(c.label){d(k).append('<div><div style="float:left;width:40%;"><label for="'+g+'">Username</label></div><div style="float:right;width:56%"><input type="text" class="'+g+'" id="'+g+'" name="'+g+'"></div><div style="clear:both;"></div></div><br>')}else{d(k).append('<input type="text" class="'+g+'" id="'+g+'" name="'+g+'">');d(k).append('<span style="position:absolute;" class="username-label">Username</span><br><br>');d(this).find("#login-box .username-label").css("left",d(this).find("#"+g).offset().left)}if(c.label){d(k).append('<div><div style="float:left;width:40%;"><label for="'+h+'">Password</label></div><div style="float:right;width:56%"><input type="password" class="'+h+'" id="'+h+'" name="'+h+'"></div><div style="clear:both;"></div></div><br>')}else{d(k).append('<input type="password" class="'+h+'" id="'+h+'" name="'+h+'">');d(k).append('<span style="position:absolute;" class="pwd-label">Password</span><br><br>');d(this).find("#login-box .pwd-label").css("left",d(this).find("#"+h).offset().left)}d(k).append('<button type="submit" id="submit">Login</button>');if(c.cancel){d(k).append('<button type="cancel" id="cancel">Cancel</button>')}break}if(c.method!=null||c.action!=null){d(k).find("button[type=submit]").bind("click",function(l){l.preventDefault()});d(this).find("#login-box span.username-label").bind("click",function(){d(f).find("#"+g).focus()});d(this).find("#login-box span.pwd-label").bind("click",function(){d(f).find("#"+h).focus()})}if(c.cancel){d(k).find("button[type=cancel]").bind("click",function(l){if(c.method!=null||c.action!=null){l.preventDefault()}d(f).find("input").val("")})}if(!c.label){d(k).find("#"+g).bind("keyup",function(){if(d(this).val().length>0){d(f).find("#login-box .username-label").hide()}else{d(f).find("#login-box .username-label").show().css("display","inline")}});d(k).find("#"+h).bind("keyup",function(){if(d(this).val().length>0){d(f).find("#login-box .pwd-label").hide()}else{d(f).find("#login-box .pwd-label").show().css("display","inline")}})}},submitLogin:function(g){var f=this;d(this).find("#login-box").find("button[type=submit]").unbind("click");d(this).find("#login-box").find("button[type=submit]").bind("click",function(j){var l=false;d(f).find("#login-box").find("#login-error").remove();if(d(f).find("#"+b).val()==""&&!l){a(f,b,"Cannot be empty!");l=true}else{if(c.email){var h=d(f).find("#"+b).val();var i=h.indexOf("@");var k=h.lastIndexOf(".");if(i<1||k<i+2||k+2>=h.length&&!l){a(f,b,"Enter a valid email address - abc@xyz.com");l=true}}}if(d(f).find("#"+e).val()==""){a(f,e,"Cannot be empty!")}if(!l){if(g!=null){g()}}else{j.preventDefault()}if((c.method==null||c.action==null)){j.preventDefault()}})},displayCustomError:function(f){d(this).find("#login-box").append('<div id="customError" style="background:#f5f5f5;padding:3px;margin:20px;box-shadow:0 3px 4px #888;"><div style="color:red;font-size:12px;font-family:Arial;padding:3px;text-align:center;">'+f+"</div></div>")},closeLogin:function(){d(this).children().remove();d(this).find("#login-box").find("button[type=submit]").unbind("click");d(this).find("#"+b).unbind("keyup");d(this).find("#"+e).unbind("keyup");d(this).find("button[type=cancel]").unbind("click");d(this).find("button[type=submit]").unbind("click");d(this).find("#login-box span.username-label").unbind("click");d(this).find("#login-box span.pwd-label").unbind("click")}})})(jQuery);